<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"../../../config/mybatis/mybatis-3-mapper.dtd">

<mapper namespace="com.emis.dao.SysManageDao">
	
	<!-- 获得全部菜单 -->
	<select id="getAllMenu" parameterType="java.util.Map" resultType="sysMenu">
		select * from menu limit #{page},#{rows}
	</select>
	
	
	<!-- 获得菜单总数 -->
	<select id="getMenuTotal" resultType="int">
		select count(*) from menu
	</select>
	
	
	<!-- 添加菜单 -->
	<insert id="addMenu" parameterType="sysMenu">
		insert into menu(mname,mcode,url,pid,createdTime) values(#{mname},#{mcode},#{url},#{pid},#{createdTime})
	</insert>
	
	
	<!-- 获得主菜单 -->
	<select id="getMenus" parameterType="java.util.Map" resultType="sysMenu">
		select * 
		from role_menu rm 
		left join menu m 
		on rm.mid=m.`id`  
		where m.pid=#{pid} 
		and rm.rid=#{rid} 
		order by m.`order`
	</select>
	
	
	<!-- 获得角色 -->
	<select id="getRoles" parameterType="java.util.Map" resultType="sysRole" >
		select * from role limit #{page},#{rows}
	</select>
	
	<select id="getRoleTotal" resultType="int">
		select count(*) from role
	</select>
	
	<!-- 添加角色 -->
	<insert id="addRole" parameterType="sysRole">
		insert into role(rname,rcode,createdTime) values(#{rname},#{rcode},sysDate())
	</insert>
	
</mapper>	